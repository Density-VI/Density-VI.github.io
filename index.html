<!DOCTYPE html>
<html>
<head>
<title>Genuis Hour</title>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
body {
    font-family: Arial, sans-serif;
    background-color: #111;
    color: white;
    text-align: center;
    margin: 0;
    padding: 0;
}
.room { padding: 40px; }
.hidden { display:none; }
input, button { padding:10px; margin:10px; }

#passedScreen {
    display:none;
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    background-color:black;
    color:lime;
    font-size:70px;
    font-weight:bold;
    justify-content:center;
    align-items:center;
}

#timerDisplay{
    font-size:22px;
    color:cyan;
}

/* Leaderboard Styles */
table {
    margin: 20px auto;
    border-collapse: collapse;
    width: 50%;
    color: white;
}
th, td {
    padding: 10px;
    border: 1px solid #fff;
}
th {
    background-color: #333;
}
</style>
</head>

<body>

<!-- START PAGE -->
<div id="startPage" class="room">
    <h1>Escape Room Challenge</h1>
    <p>Enter your username to begin:</p>
    <input type="Username" id="loginEmail" placeholder="Your username">
    <br>
    <button onclick="beginGame()">START GAME</button>
    <br><br>
    <button onclick="showLeaderboard()">View Leaderboard</button>
</div>

<div id="timerDisplay" class="hidden">Time: 0.00s</div>

<!-- ROOM 1 -->
<div id="room1" class="room hidden">
    <h1>Escape Room - Room 1</h1>
    <p>There are many things you can click...</p>

    <a href="https://www.youtube.com/watch?v=Dwnui-3-o-4b" target="_blank">
       /If u are bored click this/
    </a>
    
  <a href="https://www.youtube.com/watch?v=UG9BG7oEk7s" target="_blank">
       /This is a self advertisement/
  </a>
    <p>Enter the secret code:</p>
    <input type="text" placeholder="Type something...">

    <p>
    <button onclick="alert('if the answer is what you seek you must mute and find peace')">
        If you click this button isaac will give you a kiss 
    </button>
    </p>
</div>
      
    

<div id="passedScreen">YOU PASSED</div>

    <!-- ROOM 1 -->
<div id="room1" class="room hidden">
    <h1>Escape Room - Room 1</h1>
      <p>There are many things you can click...</p>
<!-- FINISH PAGE -->
<div id="finishPage" class="room hidden">
    <h1>YOU ESCAPED</h1>
    <h2 id="finalTime"></h2>
    <button onclick="submitScore()">Submit Score</button>
    <p id="submitStatus"></p>
</div>

    <a href="https://www.bing.com/ck/a?!&&p=d76f37d3e1251770ccebfd1f113d8ebb9f117889b1907761d18ee5e05f604a2dJmltdHM9MTc3MjMyMzIwMA&ptn=3&ver=2&hsh=4&fclid=054de15f-fde7-615e-06d2-f02ffc5d604a&u=a1L3ZpZGVvcy9yaXZlcnZpZXcvcmVsYXRlZHZpZGVvP3E9Ym9tYit0aW1lcis1K3NlY29uZHMmJm1pZD01QTk1QzYwMEZENDVGNzNCNkNCRjVBOTVDNjAwRkQ0NUY3M0I2Q0JGJmNodXJsPWh0dHBzJTNhJTJmJTJmd3d3LnlvdXR1YmUuY29tJTJmY2hhbm5lbCUyZlVDUEhtazdENGd3OUduazJlUkY2c3dGdyZGT1JNPVZBTUdaQw" target="_blank">
       self destruct
    </a>

<!-- LEADERBOARD PAGE -->
<div id="leaderboardPage" class="room hidden">
    <h1>üèÜ Global Leaderboard</h1>
    <table id="leaderboardTable">
        <tr>
            <th>Rank</th>
            <th>Email</th>
            <th>Score</th>
        </tr>
    </table>
    <br>
    <button onclick="goHome()">Back</button>
</div>

<script>
// Global variables
let playerEmail = "";
let startTime;
let timerInterval;
let inactivityTimer;

// Leaderboard storage in localStorage
const LEADERBOARD_KEY = "escapeRoomLeaderboard";

// Helper function to get leaderboard from localStorage
function getLeaderboard() {
    const leaderboard = localStorage.getItem(LEADERBOARD_KEY);
    return leaderboard ? JSON.parse(leaderboard) : [];
}

// Helper function to save leaderboard to localStorage
function saveLeaderboard(leaderboard) {
    localStorage.setItem(LEADERBOARD_KEY, JSON.stringify(leaderboard));
}

// Start the game
function beginGame() {
    const emailInput = document.getElementById("loginEmail").value;
    if (!emailInput) {
        alert("Please choose a username.");
        return;
    }

    playerEmail = emailInput;

    document.getElementById("startPage").classList.add("hidden");
    document.getElementById("room1").classList.remove("hidden");
    document.getElementById("timerDisplay").classList.remove("hidden");

    startTime = Date.now();
    timerInterval = setInterval(updateTimer, 10);

    resetIdleTimer();
}

// Update timer display
function updateTimer() {
    let elapsed = (Date.now() - startTime) / 1000;
    document.getElementById("timerDisplay").innerText = "Time: " + elapsed.toFixed(2) + "s";
}

// Stop the timer and return final time
function stopTimer() {
    clearInterval(timerInterval);
    return ((Date.now() - startTime) / 1000).toFixed(2);
}

// Reset idle timer (30 seconds of inactivity)
function resetIdleTimer() {
    clearTimeout(inactivityTimer);
    inactivityTimer = setTimeout(winGame, 30000);
}

document.addEventListener("mousemove", resetIdleTimer);
document.addEventListener("keypress", resetIdleTimer);
document.addEventListener("click", resetIdleTimer);

// Win game (after 30 seconds of inactivity or completing the game)
function winGame() {
    document.getElementById("passedScreen").style.display = "flex";
    setTimeout(() => {
        document.getElementById("passedScreen").style.display = "none";
        document.getElementById("room1").classList.add("hidden");
        document.getElementById("finishPage").classList.remove("hidden");

        let finalTime = stopTimer();
        window.playerScore = finalTime;
        document.getElementById("finalTime").innerText = "Your Time: " + finalTime + " seconds";
    }, 3000);
}

// Submit score to the leaderboard
function submitScore() {
    let leaderboard = getLeaderboard();

    // Add player's score to the leaderboard
    leaderboard.push({
        email: playerEmail,
        score: window.playerScore
    });

    // Sort leaderboard by score (ascending order)
    leaderboard.sort((a, b) => parseFloat(a.score) - parseFloat(b.score));

    // Limit to top 10 scores
    if (leaderboard.length > 10) {
        leaderboard = leaderboard.slice(0, 10);
    }

    // Save leaderboard back to localStorage
    saveLeaderboard(leaderboard);

    // Show success message
    document.getElementById("submitStatus").innerText = "Score Submitted Successfully!";
}

// Show the leaderboard
function showLeaderboard() {
    document.querySelectorAll(".room").forEach(r => r.classList.add("hidden"));
    document.getElementById("leaderboardPage").classList.remove("hidden");

    // Get leaderboard and display it
    const leaderboard = getLeaderboard();
    const table = document.getElementById("leaderboardTable");

    // Clear existing leaderboard
    table.innerHTML = `
        <tr>
            <th>Rank</th>
            <th>Email</th>
            <th>Score</th>
        </tr>
    `;

    // Populate leaderboard table
    leaderboard.forEach((entry, index) => {
        let row = table.insertRow();
        row.insertCell(0).textContent = index + 1;
        row.insertCell(1).textContent = entry.email;
        row.insertCell(2).textContent = entry.score;
    });
}

// Go back to home (reload the game)
function goHome() {
    location.reload();
}
</script>

</body>
</html>

















